# epub2audio

æ§˜ã€…ãªãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ï¼ˆEPUBã€Markdownã€HTMLï¼‰ã‹ã‚‰é«˜å“è³ªãªéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚Voicevoxã‚„Voicepeakãªã©è¤‡æ•°ã®TTSã‚¨ãƒ³ã‚¸ãƒ³ã«å¯¾å¿œã€‚

## ç‰¹å¾´

- ğŸ“š **å¤šæ§˜ãªå…¥åŠ›å½¢å¼**: EPUBã€Markdownã€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆ
- ğŸ¯ **èª­ã¿ä¸Šã’æœ€é©åŒ–**: èª­ã¿ä¸Šã’ã«é©ã—ãŸéƒ¨åˆ†ã‚’è‡ªå‹•æŠ½å‡º
- ğŸµ **æ§‹é€ ä¿æŒ**: è¦‹å‡ºã—ã‚„æ®µè½æ§‹é€ ã«å¿œã˜ãŸé©åˆ‡ãªãƒãƒ¼ã‚ºã‚’æŒ¿å…¥
- ğŸ”„ **è¤‡æ•°ã‚¨ãƒ³ã‚¸ãƒ³å¯¾å¿œ**: Voicevoxã¨Voicepeakã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
- âš¡ **é«˜é€Ÿå‡¦ç†**: ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚‹ãƒãƒƒãƒéŸ³å£°ç”Ÿæˆ

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### å‰ææ¡ä»¶

- Go 1.21ä»¥ä¸Š
- ffmpegï¼ˆéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ç”¨ï¼‰
- Voicevox ã¾ãŸã¯ Voicepeakï¼ˆTTSã‚¨ãƒ³ã‚¸ãƒ³ï¼‰

### ãƒ“ãƒ«ãƒ‰

```bash
git clone https://github.com/sbr-nakano/epub2audio.git
cd epub2audio
go build -o epub2audio cmd/epub2audio/main.go
```

## ä½¿ã„æ–¹

### åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

```bash
# EPUBãƒ•ã‚¡ã‚¤ãƒ«ã‚’éŸ³å£°ã«å¤‰æ›
epub2audio convert book.epub -o audiobook.mp3

# Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›ï¼ˆVoicevoxä½¿ç”¨ï¼‰
epub2audio convert README.md --engine voicevox -o readme.wav

# HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›ï¼ˆã‚«ã‚¹ã‚¿ãƒ è¨­å®šï¼‰
epub2audio convert article.html --config myconfig.yml
```

### è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†

```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®å…¨Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›
epub2audio convert *.md --output-dir ./audio/

# ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹ä¸€æ‹¬å‡¦ç†
epub2audio batch filelist.txt --parallel 4
```

### ãã®ä»–ã®ã‚³ãƒãƒ³ãƒ‰

```bash
# åˆ©ç”¨å¯èƒ½ãªè©±è€…ã®ä¸€è¦§è¡¨ç¤º
epub2audio list speakers --engine voicevox

# ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºã®ã¿ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼‰
epub2audio convert book.epub --dry-run --extract-text extracted.txt

# ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤º
epub2audio --help
```

## è¨­å®š

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹ï¼ˆconfig.ymlï¼‰

```yaml
# å…¥åŠ›è¨­å®š
input:
  parser: auto  # auto, markdown, epub, html
  encoding: utf-8

# å‡¦ç†è¨­å®š
processing:
  max_chunk_size: 140
  preserve_structure: true

# ãƒãƒ¼ã‚ºè¨­å®š
pause:
  strategy: standard
  standard:
    heading_1: 2000  # ãƒŸãƒªç§’
    heading_2: 1500
    paragraph: 800

# TTSã‚¨ãƒ³ã‚¸ãƒ³è¨­å®š
tts:
  engine: voicepeak  # voicepeak, voicevox
  
  voicepeak:
    narrator: "Japanese Female"
    speed: 1.0
    
  voicevox:
    speaker_id: 1  # ãšã‚“ã ã‚‚ã‚“ï¼ˆãƒãƒ¼ãƒãƒ«ï¼‰
    speed_scale: 1.0

# å‡ºåŠ›è¨­å®š
output:
  format: mp3
  bitrate: 128k
  merge: true
```

## å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

### å…¥åŠ›å½¢å¼
- EPUB (.epub)
- Markdown (.md)
- HTML (.html, .htm)

### å‡ºåŠ›å½¢å¼
- MP3ï¼ˆæ¨å¥¨ï¼‰
- WAV
- M4A

## TTSã‚¨ãƒ³ã‚¸ãƒ³

### Voicepeak
- å•†ç”¨åˆ©ç”¨å¯èƒ½ãªTTSã‚¨ãƒ³ã‚¸ãƒ³
- é«˜å“è³ªãªæ—¥æœ¬èªéŸ³å£°
- ãƒãƒ¼ã‚ºã¯å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã§åˆ¶å¾¡

### Voicevox
- ç„¡æ–™ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹TTSã‚¨ãƒ³ã‚¸ãƒ³
- å¤šæ§˜ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒœã‚¤ã‚¹
- REST APIã«ã‚ˆã‚‹åˆ¶å¾¡

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CLI Layer                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Orchestration Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Input Parser    â”‚ Text Processor   â”‚    TTS    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Markdown       â”‚ â€¢ Pause Injector â”‚ â€¢ Voicevoxâ”‚
â”‚ â€¢ EPUB          â”‚ â€¢ Text Splitter  â”‚ â€¢ Voicepeakâ”‚
â”‚ â€¢ HTML          â”‚ â€¢ Normalizer     â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é–‹ç™º

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
epub2audio/
â”œâ”€â”€ cmd/           # CLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ internal/      # å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ parser/    # å…¥åŠ›ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚   â”œâ”€â”€ tts/       # TTSã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â””â”€â”€ processor/ # ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†
â”œâ”€â”€ pkg/           # å…¬é–‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ configs/       # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹
â””â”€â”€ docs/          # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
go test ./...

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§ãƒ†ã‚¹ãƒˆ
go test -cover ./...

# ç‰¹å®šã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ
go test ./internal/parser/epub
```

### ãƒ“ãƒ«ãƒ‰

```bash
# ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰
make build

# ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
make build-all
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### VoicepeakãŒå‹•ä½œã—ãªã„
- VoicepeakãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- å®Ÿè¡Œãƒ‘ã‚¹ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒæœ‰åŠ¹ã‹ç¢ºèª

### Voicevoxã«æ¥ç¶šã§ããªã„
- VoicevoxãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: http://localhost:50021ï¼‰
- ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®šã‚’ç¢ºèª

### éŸ³å£°ãŒé€”åˆ‡ã‚Œã‚‹
- max_chunk_sizeã‚’èª¿æ•´ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 140æ–‡å­—ï¼‰
- ãƒãƒ¼ã‚ºè¨­å®šã‚’èª¿æ•´

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## è²¢çŒ®

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ã€‚å¤§ããªå¤‰æ›´ã®å ´åˆã¯ã€ã¾ãšissueã‚’ä½œæˆã—ã¦å¤‰æ›´å†…å®¹ã‚’è­°è«–ã—ã¦ãã ã•ã„ã€‚

## ä½œè€…

nakano shota (@sbr-nakano)
